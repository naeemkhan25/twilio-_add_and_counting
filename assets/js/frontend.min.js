"use strict";var ajaxurl=cwginstock.ajax_url;var security=cwginstock.security;var security_error=cwginstock.security_error;var userid=cwginstock.user_id;var emptyemail=cwginstock.empty_email;var invalidemail=cwginstock.invalid_email;var recaptcha_enabled=cwginstock.enable_recaptcha;var recaptcha_site_key=cwginstock.recaptcha_site_key;var recaptcha_verify_enabled=cwginstock.enable_recaptcha_verify;var recaptcha_secret_present=cwginstock.recaptcha_secret_present;var is_iagree=cwginstock.is_iagree_enable;var iagree_error=cwginstock.iagree_error;function cwginstock_isEmail(a){var b=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function cwginstock_recaptcha_callback(a){document.getElementsByClassName("cwgstock_button")[0].disabled=false;if(recaptcha_verify_enabled=="1"&&recaptcha_secret_present=="yes"){document.getElementsByClassName("cwg-security")[0].value=a}}var googlerecaptcha_widget_id=null;var onloadCallback=function(){if(recaptcha_enabled=="1"){if(jQuery("#cwg-google-recaptcha").length){if(googlerecaptcha_widget_id===null){googlerecaptcha_widget_id=grecaptcha.render("cwg-google-recaptcha",{sitekey:recaptcha_site_key,callback:cwginstock_recaptcha_callback})}else{grecaptcha.reset(googlerecaptcha_widget_id);cwginstock_recaptcha_callback();googlerecaptcha_widget_id=null;onloadCallback()}}}};var resetcallback=function(){if(recaptcha_enabled=="1"){grecaptcha.reset();document.getElementsByClassName("cwgstock_button")[0].disabled=true}};jQuery(function(){jQuery(".single_variation_wrap").on("show_variation",function(c,b){var a=b.variation_id;jQuery(".cwginstock-subscribe-form").hide();jQuery(".cwginstock-subscribe-form-"+a).show();if(recaptcha_enabled=="1"){onloadCallback()}});jQuery(document).on("click",".cwgstock_button",function(){var f=jQuery(this);var a=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_email").val();var c=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-product-id").val();var e=jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg-variation-id").val();if(a==""){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+emptyemail+"</div>");return false}else{if(!cwginstock_isEmail(a)){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+invalidemail+"</div>");return false}if(is_iagree=="1"){if(!jQuery(this).closest(".cwginstock-subscribe-form").find(".cwg_iagree_checkbox_input").is(":checked")){jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn();jQuery(this).closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+iagree_error+"</div>");return false}}var d={action:"cwginstock_product_subscribe",product_id:c,variation_id:e,user_email:a,user_id:userid,security:security,dataobj:cwginstock};if(jQuery.fn.block){f.closest(".cwginstock-subscribe-form").block({message:null})}else{var b=jQuery('<div id="cwg-bis-overlay"> </div>');b.appendTo(f.closest(".cwginstock-subscribe-form"))}jQuery.ajax({type:"post",url:ajaxurl,data:d,success:function(g){f.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2000);f.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html(g);if(jQuery.fn.block){f.closest(".cwginstock-subscribe-form").unblock()}else{f.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,function(){f.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})}resetcallback()},error:function(i,g,h){if(i.responseText==="-1"||i.responseText===-1){f.closest(".cwginstock-subscribe-form").find(".cwgstock_output").fadeIn(2000);f.closest(".cwginstock-subscribe-form").find(".cwgstock_output").html("<div class='cwginstockerror' style='color:red;'>"+security_error+"</div>")}if(jQuery.fn.block){f.closest(".cwginstock-subscribe-form").unblock()}else{f.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").fadeOut(400,function(){f.closest(".cwginstock-subscribe-form").find("#cwg-bis-overlay").remove()})}resetcallback()}})}return false})});